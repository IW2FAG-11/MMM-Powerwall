<div class="MMM-Powerwall flexbox">
{% set endDiv = joiner(["</div>"]) -%}
{% for graph in config.graphs %}
    {{ endDiv() | safe }}
    <div class="module MMM-Powerwall module-content flexitem">
        {% if graph == "SolarProduction" -%}
            {% if flows %}
                <div class="MMM-Powerwall grid-left">
                  <div class="MMM-Powerwall col1">
                    <p class="small bright">Solar is currently producing</p>
                    <p id="{{id}}-SolarProduction" class="big solar">
                        {%- if flows.sources.solar.total > 950 -%}
                            {{ flows.sources.solar.total // 100 / 10 }} kW
                        {%- else -%}
                            {{ flows.sources.solar.total // 1 }} W
                        {%- endif %}</p>
                    <p class="small bright" id="{{id}}-SolarTotal"></p>
                  </div>
                  <div class="MMM-Powerwall col2 graph-container">
                    <canvas id="{{id}}-SolarDestinations">
                        Graph goes here
                    </canvas>
                  </div>
                </div>
            {%- else -%}
                LOADING...
            {%-endif -%}
        {%- elif graph == "HouseConsumption" -%}
            {% if flows %}
                <div class="MMM-Powerwall grid-right">
                  <div class="MMM-Powerwall col1 graph-container">
                    <canvas id="{{id}}-HouseSources">
                        Graph goes here
                    </canvas>
                  </div>
                  <div class="MMM-Powerwall col2">
                    <p class="small bright">House is currently consuming</p>
                    <p id="{{id}}-HouseConsumption" class="big house">
                        {%- if flows.sinks.house.total > 950 -%}
                            {{ flows.sinks.house.total // 100 / 10 }} kW
                        {%- else -%}
                            {{ flows.sinks.house.total // 1 }} W
                        {%- endif %}</p>
                    <p class="small bright" id="{{id}}-UsageTotal"></p>
                  </div>
                </div>
            {%- else -%}
                LOADING...
            {%-endif -%}
        {%- elif graph == "PowerwallSelfPowered" -%}
            <div class="MMM-Powerwall grid-equal">
                <div class="scene MMM-Powerwall col1">
                    <div class="MMM-Powerwall cube">
                        <div class="cube__face cube__face--front" 
                             id="{{id}}-PowerwallSOE"></div>
                        <div class="cube__face cube__face--right">
                            <div class="battery meter" style="height: 0%;"
                                 id="{{id}}-battery-meter"></div>
                        </div>
                    </div>
                </div>
                <div class="MMM-Powerwall col2 graph-container">
                    <canvas id="{{id}}-SelfPowered">
                        Graph goes here
                    </canvas>
                </div>
            </div>

        {%- elif graph == "CarCharging" -%}
        {%- elif graph == "PowerFlow" -%}
        {%- else -%}
        Unknown graph type selected
        {%- endif -%}
{%- endfor %}
    </div>
</div>